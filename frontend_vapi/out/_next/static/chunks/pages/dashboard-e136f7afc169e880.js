(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9724],{36104:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>g});var s=l(94458),r=l(43836),o=l(68337),a=l.n(o),d=l(13130),i=l(68658),n=l(99839),c=l(43054);let x=l(2272).env.NEXT_PUBLIC_SESSION_SIGNER_ID;function m(e){let{wallet:t}=e,{addSessionSigners:l,removeSessionSigners:o}=(0,n.Zv)(),{signMessage:a}=(0,n.YN)(),{signMessage:d}=(0,n.YN)(),[m,b]=(0,i.useState)(!1),[u,g]=(0,i.useState)(!1),[h,v]=(0,i.useState)(!1),p=!0===t.delegated,y=(0,i.useCallback)(async e=>{if(!x)return void console.error("SESSION_SIGNER_ID must be defined to addSessionSigner");b(!0);try{await l({address:e,signers:[{signerId:x,policyIds:[]}]})}catch(e){console.error("Error adding session signer:",e)}finally{b(!1)}},[l]),w=(0,i.useCallback)(async e=>{b(!0);try{await o({address:e})}catch(e){console.error("Error removing session signer:",e)}finally{b(!1)}},[o]),N=(0,i.useCallback)(async()=>{v(!0);try{let e,l="Signing this message to verify ownership of ".concat(t.address);"ethereum"===t.chainType?e=(await a({message:l})).signature:"solana"===t.chainType&&(e=(await d({message:l})).signature),console.log("Message signed on client! Signature: ",e)}catch(e){console.error("Error signing message:",e)}finally{v(!1)}},[t]),j=(0,i.useCallback)(async()=>{g(!0);try{let e=await (0,r.A)(),l="ethereum"===t.chainType?"/api/ethereum/personal_sign":"/api/solana/sign_message",s="Signing this message to verify ownership of ".concat(t.address),o=await c.A.post(l,{wallet_id:t.id,message:s},{headers:{Authorization:"Bearer ".concat(e)}}),a=o.data;if(200===o.status)console.log("Message signed on server! Signature: "+a.data.signature);else throw Error(a.error||"Failed to sign message")}catch(e){console.error("Error signing message:",e)}finally{g(!1)}},[t.id]);return(0,s.jsxs)("div",{className:"flex flex-col gap-4 p-4 border border-gray-200 rounded-lg",children:[(0,s.jsxs)("div",{className:"text-sm text-violet-700",children:["privy"===t.walletClientType?"Embedded ":"","Wallet:"," ",t.address.slice(0,6),"...",t.address.slice(-4)]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,s.jsx)("button",{onClick:()=>y(t.address),disabled:m||p,className:"text-sm py-2 px-4 rounded-md text-white ".concat(m||p?"bg-violet-400 cursor-not-allowed":"bg-violet-600 hover:bg-violet-700"),children:m?"Processing...":"Add Session Signer"}),(0,s.jsx)("button",{onClick:()=>w(t.address),disabled:m||!p,className:"text-sm py-2 px-4 rounded-md text-white ".concat(m||!p?"bg-red-400 cursor-not-allowed":"bg-red-600 hover:bg-red-700"),children:m?"Processing...":"Remove Session Signer"})]}),p&&(0,s.jsx)("div",{className:"mt-2 text-sm text-gray-600",children:"This wallet has active session signers"}),(0,s.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,s.jsx)("button",{onClick:j,disabled:u||!p,className:"text-sm py-2 px-4 rounded-md text-white ".concat(u||!p?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"),children:u?"Signing...":"Sign message from server"}),(0,s.jsx)("button",{onClick:N,disabled:h,className:"text-sm py-2 px-4 rounded-md text-white ".concat(h?"bg-green-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"),children:h?"Signing...":"Sign message from client"})]})]})}function b(){let{user:e}=(0,n.Jd)(),{createWallet:t}=(0,r.S)(),{createWallet:l}=(0,r.T)(),[o,a]=(0,i.useState)(!1),d=(0,i.useMemo)(()=>{var t;return null!=(t=null==e?void 0:e.linkedAccounts.filter(e=>"wallet"===e.type&&"privy"===e.walletClientType&&"ethereum"===e.chainType))?t:[]},[e]),c=(0,i.useMemo)(()=>{var t;return null!=(t=null==e?void 0:e.linkedAccounts.filter(e=>"wallet"===e.type&&"privy"===e.walletClientType&&"solana"===e.chainType))?t:[]},[e]),x=(0,i.useCallback)(async e=>{a(!0);try{"ethereum"===e?await t():"solana"===e&&await l()}catch(e){console.error("Error creating wallet:",e)}finally{a(!1)}},[t,l]);return(0,s.jsxs)("div",{className:"space-y-4",children:[0===d.length?(0,s.jsxs)("div",{className:"p-4 border border-gray-200 rounded-lg text-center",children:[(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"No Ethereum embedded wallets found."}),(0,s.jsx)("button",{onClick:()=>x("ethereum"),disabled:o,className:"text-sm bg-violet-600 hover:bg-violet-700 py-2 px-4 rounded-md text-white disabled:bg-violet-400 disabled:cursor-not-allowed",children:o?"Creating...":"Create Ethereum Embedded Wallet"})]}):(0,s.jsx)("div",{className:"space-y-4",children:d.map(e=>(0,s.jsx)(m,{wallet:e},e.address))}),0===c.length?(0,s.jsxs)("div",{className:"p-4 border border-gray-200 rounded-lg text-center",children:[(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"No Solana embedded wallets found."}),(0,s.jsx)("button",{onClick:()=>x("solana"),disabled:o,className:"text-sm bg-violet-600 hover:bg-violet-700 py-2 px-4 rounded-md text-white disabled:bg-violet-400 disabled:cursor-not-allowed",children:o?"Creating...":"Create Solana Embedded Wallet"})]}):(0,s.jsx)("div",{className:"space-y-4",children:c.map(e=>(0,s.jsx)(m,{wallet:e},e.address))})]})}async function u(){try{let e=await (0,r.A)();return e?{token:e}:null}catch(e){return console.error("Failed to get access token:",e),null}}function g(){var e,t,l,o;let[n,c]=(0,i.useState)(),x=(0,d.useRouter)(),{ready:m,authenticated:g,user:h,logout:v,linkEmail:p,linkWallet:y,unlinkEmail:w,linkPhone:N,unlinkPhone:j,unlinkWallet:f,linkGoogle:k,unlinkGoogle:C,linkTwitter:S,unlinkTwitter:E,linkDiscord:_,unlinkDiscord:T}=(0,r.H)();(0,i.useEffect)(()=>{m&&!g&&x.push("/")},[m,g,x]);let A=((null==h||null==(e=h.linkedAccounts)?void 0:e.length)||0)>1,I=null==h?void 0:h.email,U=null==h?void 0:h.phone,P=null==h?void 0:h.wallet,D=(null==h||null==(t=h.google)?void 0:t.subject)||null,M=(null==h||null==(l=h.twitter)?void 0:l.subject)||null,O=(null==h||null==(o=h.discord)?void 0:o.subject)||null;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a(),{children:(0,s.jsx)("title",{children:"Privy Auth Demo"})}),(0,s.jsx)("main",{className:"flex flex-col min-h-screen px-4 sm:px-20 py-6 sm:py-10 bg-privy-light-blue",children:m&&g?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,s.jsx)("h1",{className:"text-2xl font-semibold",children:"Privy Auth Demo"}),(0,s.jsx)("button",{onClick:v,className:"text-sm bg-violet-200 hover:text-violet-900 py-2 px-4 rounded-md text-violet-700",children:"Logout"})]}),(0,s.jsxs)("div",{className:"mt-12 flex gap-4 flex-wrap",children:[D?(0,s.jsx)("button",{onClick:()=>{C(D)},className:"text-sm border border-violet-600 hover:border-violet-700 py-2 px-4 rounded-md text-violet-600 hover:text-violet-700 disabled:border-gray-500 disabled:text-gray-500 hover:disabled:text-gray-500",disabled:!A,children:"Unlink Google"}):(0,s.jsx)("button",{onClick:()=>{k()},className:"text-sm bg-violet-600 hover:bg-violet-700 py-2 px-4 rounded-md text-white",children:"Link Google"}),M?(0,s.jsx)("button",{onClick:()=>{E(M)},className:"text-sm border border-violet-600 hover:border-violet-700 py-2 px-4 rounded-md text-violet-600 hover:text-violet-700 disabled:border-gray-500 disabled:text-gray-500 hover:disabled:text-gray-500",disabled:!A,children:"Unlink Twitter"}):(0,s.jsx)("button",{className:"text-sm bg-violet-600 hover:bg-violet-700 py-2 px-4 rounded-md text-white",onClick:()=>{S()},children:"Link Twitter"}),O?(0,s.jsx)("button",{onClick:()=>{T(O)},className:"text-sm border border-violet-600 hover:border-violet-700 py-2 px-4 rounded-md text-violet-600 hover:text-violet-700 disabled:border-gray-500 disabled:text-gray-500 hover:disabled:text-gray-500",disabled:!A,children:"Unlink Discord"}):(0,s.jsx)("button",{className:"text-sm bg-violet-600 hover:bg-violet-700 py-2 px-4 rounded-md text-white",onClick:()=>{_()},children:"Link Discord"}),I?(0,s.jsx)("button",{onClick:()=>{w(I.address)},className:"text-sm border border-violet-600 hover:border-violet-700 py-2 px-4 rounded-md text-violet-600 hover:text-violet-700 disabled:border-gray-500 disabled:text-gray-500 hover:disabled:text-gray-500",disabled:!A,children:"Unlink email"}):(0,s.jsx)("button",{onClick:p,className:"text-sm bg-violet-600 hover:bg-violet-700 py-2 px-4 rounded-md text-white",children:"Connect email"}),P?(0,s.jsx)("button",{onClick:()=>{f(P.address)},className:"text-sm border border-violet-600 hover:border-violet-700 py-2 px-4 rounded-md text-violet-600 hover:text-violet-700 disabled:border-gray-500 disabled:text-gray-500 hover:disabled:text-gray-500",disabled:!A,children:"Unlink wallet"}):(0,s.jsx)("button",{onClick:y,className:"text-sm bg-violet-600 hover:bg-violet-700 py-2 px-4 rounded-md text-white border-none",children:"Connect wallet"}),U?(0,s.jsx)("button",{onClick:()=>{j(U.number)},className:"text-sm border border-violet-600 hover:border-violet-700 py-2 px-4 rounded-md text-violet-600 hover:text-violet-700 disabled:border-gray-500 disabled:text-gray-500 hover:disabled:text-gray-500",disabled:!A,children:"Unlink phone"}):(0,s.jsx)("button",{onClick:N,className:"text-sm bg-violet-600 hover:bg-violet-700 py-2 px-4 rounded-md text-white border-none",children:"Connect phone"}),(0,s.jsx)("button",{onClick:()=>u().then(c),className:"text-sm bg-violet-600 hover:bg-violet-700 py-2 px-4 rounded-md text-white border-none",children:"Verify token on server"}),!!n&&(0,s.jsxs)("details",{className:"w-full",children:[(0,s.jsx)("summary",{className:"mt-6 font-bold uppercase text-sm text-gray-600",children:"Server verify result"}),(0,s.jsx)("pre",{className:"max-w-4xl bg-slate-700 text-slate-50 font-mono p-4 text-xs sm:text-sm rounded-md mt-2",children:JSON.stringify(n,null,2)})]})]}),(0,s.jsxs)("div",{className:"space-y-6 max-w-4xl mt-6",children:[(0,s.jsx)("h2",{className:"text-xl font-bold",children:"Your Wallet"}),(0,s.jsx)(b,{})]}),(0,s.jsx)("p",{className:"mt-6 font-bold uppercase text-sm text-gray-600",children:"User object"}),(0,s.jsx)("pre",{className:"max-w-4xl bg-slate-700 text-slate-50 font-mono p-4 text-xs sm:text-sm rounded-md mt-2",children:JSON.stringify(h,null,2)})]}):null})]})}},88005:(e,t,l)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return l(36104)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[3123,636,6593,8792],()=>t(88005)),_N_E=e.O()}]);